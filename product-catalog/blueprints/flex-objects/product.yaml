title: 'Product'
description: 'Product'
type: flex-objects

# Flex Configuration
config:
    # Administration Configuration
    admin:
        # Admin router (optional)
        router:
            path: '/product'

        # Admin menu (optional)
        menu:
            list:
                route: '/product'
                title: 'Каталог'
                icon: fa-shop
                # Authorization to collection admin
                authorize: ['admin.product.list', 'admin.super']
                # Priority -10 .. 10 (highest goes up)
                priority: 5

        # Admin template type / folder
        template: default

        # Permissions
        permissions:
            # Primary permissions
            admin.product:
                type: crudpl
                label: 'Product'

        list:
            title: name
            fields:
                name:
                    link: edit
                price:
                discount:
                leftCount:
                isHit:
                isAd:
                published:

        edit:
            title:
                template: '{{ object.name ?? ''Новый товар'' }}'

        preview:
            enabled: false
            route:
            #template: '/plugins/flex-objects/directory:contacts'


    # Site Configuration
    site:
        templates:
            collection:
                # Lookup for the template layout files for collections of objects
                paths:
                    - 'flex/{TYPE}/collection/{LAYOUT}{EXT}'
            object:
                # Lookup for the template layout files for objects
                paths:
                    - 'flex/{TYPE}/object/{LAYOUT}{EXT}'
            defaults:
                # Default template {TYPE}; overridden by filename of this blueprint if template folder exists
                type: 'product'
                # Default template {LAYOUT}; can be overridden in render calls (usually Twig in templates)
                layout: default

    # Data Configuration
    data:
        # Object class to be used, allowing custom methods for the object
        object: 'Grav\Plugin\ProductCatalog\Flex\Types\Product\ProductObject'
        # Collection class to be used, allowing custom methods for the collections
        collection: 'Grav\Plugin\ProductCatalog\Flex\Types\Product\ProductCollection'
        # Index class to be used, works as a quick database-like lookup index
        index: 'Grav\Common\Flex\Types\Generic\GenericIndex'
        storage:
            # Storage class, use single file storage (does not support images and assets)
            class: 'Grav\Framework\Flex\Storage\SimpleStorage'
            options:
                formatter:
                    # File formatter class, in this case the file is stored in markdown
                    class: 'Grav\Framework\File\Formatter\JsonFormatter'
                # JSON file where all the objects will be stored
                folder: user-data://product
        search:
            # Search options
            options:
                contains: 1
            # Fields to be searched
            fields:
                - name
                - description

form:
    validation: loose
    fields:
        published:
            type: toggle
            label: Опубликован
            default: 1
            options:
                1: Да
                0: Нет
            validate:
                required: true
        name:
            type: text
            label: Название Товара
            validate:
                required: true
        slug:
            type: text
            label: Название в ссылке
            placeholder: 'teplica-mini-2-0'
            validate:
                required: true
            classes: live-slug-from-name
        meta:
            type: array
            label: PLUGIN_ADMIN.METADATA
            placeholder_key: PLUGIN_ADMIN.METADATA_KEY
            placeholder_value: PLUGIN_ADMIN.METADATA_VALUE
        category:
            type: select
            label: Категории
            multiple: true
            size: long
            data-options@: '\Grav\Plugin\ProductCatalogPlugin::getCategories'
            validate:
                type: array
        price:
            type: number
            label: Цена
            validate:
                required: true
        isHit:
            type: toggle
            label: Хит
            default: 0
            options:
                1: Да
                0: Нет
            validate:
                required: true
        isAd:
            type: toggle
            label: На Акции
            default: 1
            options:
                1: Да
                0: Нет
            validate:
                required: true
        leftCount:
            type: number
            label: Осталось на складе
            default: 6
            validate:
                required: true
        discount:
            type: number
            label: Скидка
            default: 25
            prepend: '%'
            validate:
                required: true
        preview:
            type: file
            label: Первью (в Карточке)
            destination: 'user/data/images'
            multiple: false
            random_name: true
            accept:
            - image/*
        gallery:
            type: file
            label: Галерея
            destination: 'user/data/images'
            multiple: true
            random_name: true
            accept:
            - image/*
        length:
            type: select
            label: Начальная Длина Теплицы
            options:
                "4": 4 м.
                "6": 6 м.
                "8": 8 м.
                "10": 10 м.
            default: 4
            validate:
                required: true
        step:
            type: select
            label: Начальная Шаг между дугами
            options:
                "1": 1 м.
                "0.67": 0.67 м.
                "0.5": 0.5 м.
            default: 1
            validate:
                required: true
        width:
            type: text
            label: Ширина Теплицы
            default: 2
            validate:
                required: true
        height:
            type: text
            label: Высота
            default: '2.1м и 1.75м'
            validate:
                required: true
        profil:
            type: select
            label: Профиль
            options:
                "20x20": 20x20
                "20x40": 20x40
                "30x20": 30x20
                "40x20": 40x20
                "40x40": 40x40
            default: 20x20
            validate:
                required: true
        props:
            type: array
            label: Параметры
            placeholder_key: Производитель
            placeholder_value: Беларусь
            default:
                Производитель: Сэлмакс Групп ПК
                Страна производства: Беларусь
                Гарантия: 12 месяцев
        description:
            type: markdown
            label: Описание товара
            size: large
            validate:
                required: true
        variants:
            name: variants
            type: list
            style: vertical
            collapsed: true
            label: Ценовые варианты (Калькулятор)
            fields:
                .length:
                    type: select
                    label: Длина Теплицы
                    options:
                        "2": 2 м.
                        "4": 4 м.
                        "6": 6 м.
                        "8": 8 м.
                        "10": 10 м.
                    default: 4
                .value:
                    type: list
                    collapsed: true
                    style: vertical
                    label: Цены
                    fields:
                        .step:
                            type: select
                            label: Шаг между дугами
                            options:
                                "1": 1 м.
                                "0.67": 0.67 м.
                                "0.5": 0.5 м.
                            default: 1
                        .price:
                            type: number
                            label: Цена
                            min: 0
                            step: 50
                            default: 500
